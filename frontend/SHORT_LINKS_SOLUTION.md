# –†–µ—à–µ–Ω–∏–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ—Ä–æ—Ç–∫–∏–º–∏ —Å—Å—ã–ª–∫–∞–º–∏ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

–ö–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://yandex.ru/maps/-/CHXXEC87`) –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∞–¥—Ä–µ—Å –≤ —á–∏—Ç–∞–µ–º–æ–º –≤–∏–¥–µ –≤ URL. –°—Ç–∞—Ä—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–ª —á–∞—Å—Ç—å URL –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–°–æ–∑–¥–∞–Ω–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ —Ç–∏–ø—ã —Å—Å—ã–ª–æ–∫ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç:

### 1. –°–µ—Ä–≤–µ—Ä–Ω—ã–π API –¥–ª—è –≤–µ–±-—Å–∫—Ä–∞–ø–∏–Ω–≥–∞

**–§–∞–π–ª:** `backend/routers/address_extraction.py`

```python
@router.get("/extract-address")
async def extract_address_from_yandex_link(url: str):
    """
    –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∞–¥—Ä–µ—Å –∏–∑ —Å—Å—ã–ª–∫–∏ –Ω–∞ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã, –≤–∫–ª—é—á–∞—è –∫–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏
    """
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—ã—á–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ —Å –∞–¥—Ä–µ—Å–æ–º
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Å—ã–ª–æ–∫ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ (–æ–±—Ä–∞—Ç–Ω–æ–µ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- ‚úÖ **–í–µ–±-—Å–∫—Ä–∞–ø–∏–Ω–≥ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Å—ã–ª–æ–∫**
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ HTML –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ –∏–∑ –∫–∞—Ä—Ç–æ—á–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

### 2. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### SimpleAddressFromYandexMaps.jsx
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–±—ã—á–Ω—ã–µ —Å—Å—ã–ª–∫–∏
- –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏
- –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ

#### AdvancedAddressFromYandexMaps.jsx
- –ü—ã—Ç–∞–µ—Ç—Å—è –≤–µ–±-—Å–∫—Ä–∞–ø–∏–Ω–≥ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω CORS –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–∏—Å—ã

#### ServerBasedAddressExtractor.jsx ‚≠ê **–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ä–≤–µ—Ä–Ω—ã–π API
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ —Ç–∏–ø—ã —Å—Å—ã–ª–æ–∫
- –ù–∞–¥–µ–∂–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –ê–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Å—ã–ª–æ–∫:

1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Å—Å—ã–ª–∫–∏**
   ```javascript
   if (url.includes('/maps/-/')) {
       // –ö–æ—Ä–æ—Ç–∫–∞—è —Å—Å—ã–ª–∫–∞ - –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–µ–±-—Å–∫—Ä–∞–ø–∏–Ω–≥
   } else {
       // –û–±—ã—á–Ω–∞—è —Å—Å—ã–ª–∫–∞ - –ø–∞—Ä—Å–∏–º URL
   }
   ```

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—ã—á–Ω—ã—Ö —Å—Å—ã–ª–æ–∫**
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `text`
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ –ø—É—Ç–∏ URL
   - –û–±—Ä–∞—Ç–Ω–æ–µ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Å—ã–ª–æ–∫**
   ```python
   async def extract_address_from_short_link(short_url: str):
       # –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
       response = await client.get(short_url)
       html = response.text
       
       # –ü–∞—Ä—Å–∏–º HTML
       soup = BeautifulSoup(html, 'html.parser')
       
       # –ò—â–µ–º –∞–¥—Ä–µ—Å –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö:
       # 1. –ú–µ—Ç–∞-—Ç–µ–≥–∏
       # 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (JSON-LD)
       # 3. –¢–µ–∫—Å—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
       # 4. –ó–∞–≥–æ–ª–æ–≤–∫–∏
       # 5. –ö–∞—Ä—Ç–æ—á–∫–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
   ```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```txt
beautifulsoup4==4.12.2  # –ü–∞—Ä—Å–∏–Ω–≥ HTML
lxml==4.9.3             # XML/HTML –ø–∞—Ä—Å–µ—Ä
httpx==0.26.0           # HTTP –∫–ª–∏–µ–Ω—Ç
```

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤

| –ú–µ—Ç–æ–¥ | –û–±—ã—á–Ω—ã–µ —Å—Å—ã–ª–∫–∏ | –ö–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏ | –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å | –°–∫–æ—Ä–æ—Å—Ç—å |
|-------|----------------|-----------------|------------|----------|
| **SimpleAddressFromYandexMaps** | ‚úÖ | ‚ùå | –í—ã—Å–æ–∫–∞—è | –ë—ã—Å—Ç—Ä–∞—è |
| **AdvancedAddressFromYandexMaps** | ‚úÖ | ‚ö†Ô∏è (CORS) | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω—è—è |
| **ServerBasedAddressExtractor** | ‚úÖ | ‚úÖ | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω—è—è |

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
cd backend
pip install beautifulsoup4 lxml
```

### 2. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–∞
```python
# –í main.py
from routers.address_extraction import router as address_router
app.include_router(address_router, prefix="/api")
```

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
```jsx
import ServerBasedAddressExtractor from './components/ServerBasedAddressExtractor'

<ServerBasedAddressExtractor
  value={address}
  onChange={setAddress}
  placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã"
/>
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞:
- http://localhost:5173/test_short_links.html

### –ü—Ä–∏–º–µ—Ä—ã —Å—Å—ã–ª–æ–∫:

**‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è:**
```
https://yandex.ru/maps/213/moscow/?ll=37.617635%2C55.755814&z=16&text=—É–ª–∏—Ü–∞%20–¢–≤–µ—Ä—Å–∫–∞—è%2C%201
https://yandex.ru/maps/213/moscow/?ll=37.617635%2C55.755814&z=16
https://yandex.ru/maps/-/CHXXEC87
https://yandex.ru/maps/-/CCUu8XeB
```

**‚ùå –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è:**
```
https://yandex.ru/maps/  # –ù–µ–ø–æ–ª–Ω–∞—è —Å—Å—ã–ª–∫–∞
https://google.com/maps   # –ù–µ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã
```

## üîç –ê–ª–≥–æ—Ä–∏—Ç–º –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML

### 1. –ú–µ—Ç–∞-—Ç–µ–≥–∏
```html
<meta property="og:description" content="–ê–¥—Ä–µ—Å: —É–ª. –¢–≤–µ—Ä—Å–∫–∞—è, 1">
```

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```html
<script type="application/ld+json">
{
  "address": {
    "streetAddress": "—É–ª. –¢–≤–µ—Ä—Å–∫–∞—è, 1"
  }
}
</script>
```

### 3. –¢–µ–∫—Å—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã
```javascript
const patterns = [
  /–∞–¥—Ä–µ—Å[:\s]+([^,\n]+)/i,
  /–Ω–∞—Ö–æ–¥–∏—Ç—Å—è[:\s]+([^,\n]+)/i,
  /—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω[:\s]+([^,\n]+)/i
]
```

### 4. –ó–∞–≥–æ–ª–æ–≤–∫–∏
```html
<h2>–ê–¥—Ä–µ—Å</h2>
<p>—É–ª. –¢–≤–µ—Ä—Å–∫–∞—è, 1</p>
```

### 5. –ö–∞—Ä—Ç–æ—á–∫–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
```html
<div class="address">—É–ª. –¢–≤–µ—Ä—Å–∫–∞—è, 1</div>
```

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
1. **CORS –ø–æ–ª–∏—Ç–∏–∫–∏** - –≤–µ–±-—Å–∫—Ä–∞–ø–∏–Ω–≥ —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
2. **–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å–∞–π—Ç–∞** - –Ø–Ω–¥–µ–∫—Å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å HTML —Å—Ç—Ä—É–∫—Ç—É—Ä—É
3. **Rate limiting** - —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç –±—ã—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ServerBasedAddressExtractor** –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π —Ä–∞–±–æ—Ç—ã
2. **–ö—ç—à–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å—Å—ã–ª–æ–∫
3. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏** –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å–∞–π—Ç–∞

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- –í–≤–æ–¥: `https://yandex.ru/maps/-/CHXXEC87`
- –†–µ–∑—É–ª—å—Ç–∞—Ç: `CHXXEC87` ‚ùå

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- –í–≤–æ–¥: `https://yandex.ru/maps/-/CHXXEC87`
- –†–µ–∑—É–ª—å—Ç–∞—Ç: `—É–ª. –¢–≤–µ—Ä—Å–∫–∞—è, 1` ‚úÖ

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–æ–∑–¥–∞–Ω–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ:
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ —Ç–∏–ø—ã —Å—Å—ã–ª–æ–∫ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–µ–±-—Å–∫—Ä–∞–ø–∏–Ω–≥ –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Å—ã–ª–æ–∫
- ‚úÖ –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞
- ‚úÖ –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –õ–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ServerBasedAddressExtractor` –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.** 